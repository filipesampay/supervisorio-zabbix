zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: 7df96b18c230490a9a0a9e2307226338
      name: Templates
  templates:
    - uuid: a6a153ced1274209b5b0d81becc7874b
      template: 'UBQT UNIFI SNMP V1 HN'
      name: 'UBQT UNIFI SNMP V1 HN'
      description: |
        ## Description
        
        This template retrieve SNMP data from Unifi AP devices. MIBS requiriments: FROGFOOT-RESOURCES-MIB IANAifType-MIB IF-MIB SNMP-FRAMEWORK-MIB SNMPv2-CONF SNMPv2-MIB SNMPv2-SMI SNMPv2-TC UBNT-MIB UBNT-UniFi-MIB Author: Alex Moura
        
        ## Overview
        
        Explicação detalhada no link do site.  
        Detailed instructions on website link.  
          
        This template retrieve SNMP data from Unifi AP devices.  
          
        Model, Firmware Version, Uptime, IP Address, MAC Address, Interface speed, LAN port Speed and real time traffic, CPU Load, CPU usage, WIFI SSIDs, Traffic/SSID, Users/SSID, AP Hostname, Channel Utilization 2G and 3G,   
          
        Traffic graphics, Users graphics,   
          
        Triggers: CPU Load, Channel usage.  
          
        MIBS requirements:  
        FROGFOOT-RESOURCES-MIB . IANAifType-MIB , IF-MIB , SNMP-FRAMEWORK-MIB , SNMPv2-CONF. SNMPv2-MIB, SNMPv2-SMI, SNMPv2-TC  
        UBNT-MIB, UBNT-UniFi-MIB  
          
        Tested on: (LOCAL and PROXY environments)  
          
        Models tested: UAP, UAP-LR. UAP-LRv2, UAP-AC-LR, UAP-AC-Lite  
          
        (in progress)  
          
        Requirements:  
        AP firmware above 3.9.X  
        AP SNMP feature enabled  
          
         If you Like let a comment to help me make this template better.  
        Se voce gostou deixe um comentário com sugestões para melhoria do template.
        
        
        
        ## Author
        
        Alex Moura
      groups:
        - name: Templates
      items:
        - uuid: e3b9b3eb0c9f4a1192cdc4ed03af1e87
          name: 'Utilização do CPU'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.25.3.3.1.2.196608
          key: cpuLoad.0
          delay: 30s
          history: 1w
          units: '%'
          tags:
            - tag: Application
              value: CPU
        - uuid: 1cea5853cde943ca974ad10daba3d185
          name: 'Hora do sistema'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.25.1.2.0
          key: hrSystemDate.0
          delay: 30s
          history: 1d
          value_type: TEXT
          trends: '0'
          tags:
            - tag: Application
              value: System
        - uuid: 45fafd8f2ebb4788911c25f065ff69a4
          name: 'Carga AVG da CPU em 1 minuto'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2021.10.1.3.1
          key: IaLoad.1
          history: 1w
          value_type: FLOAT
          tags:
            - tag: Application
              value: CPU
          triggers:
            - uuid: 30cef634502e4756a62088717f4a17a9
              expression: 'avg(/UBQT UNIFI SNMP V1 HN/IaLoad.1,5m)>1'
              name: 'A carga do processador está muito alta {HOST.NAME}'
              priority: AVERAGE
            - uuid: e17dcce16a45495f99ec09329006ba25
              expression: 'avg(/UBQT UNIFI SNMP V1 HN/IaLoad.1,5m)>3'
              name: 'A carga do processador está muito alta {HOST.NAME}'
              priority: HIGH
        - uuid: 069f8bfbcad04c86bcab725200aafd43
          name: 'Carga AVG da CPU em 5 minutos'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2021.10.1.3.2
          key: IaLoad.2
          history: 1w
          value_type: FLOAT
          tags:
            - tag: Application
              value: CPU
        - uuid: 7dc3de9dcf0b4e9d8cbd443d9e284200
          name: 'Carga AVG da CPU 15 minutos'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.2021.10.1.3.3
          key: IaLoad.3
          history: 1w
          value_type: FLOAT
          tags:
            - tag: Application
              value: CPU
        - uuid: 6d68696ff2ee4f8eadbb9fe0ad19b02f
          name: Contato
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.4.0
          key: sysContact.0
          delay: 60m
          history: 1w
          value_type: TEXT
          trends: '0'
          description: 'Informa o modelo do aparelho'
          inventory_link: CONTACT
          tags:
            - tag: Application
              value: System
        - uuid: a0c3eb45b59e4bffb2fc1aa067edf54e
          name: 'Descrição do sistema'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.1.0
          key: sysDescr.0
          delay: 30m
          history: 1w
          value_type: TEXT
          trends: '0'
          description: 'Informa o modelo do aparelho'
          inventory_link: HARDWARE_FULL
          tags:
            - tag: Application
              value: System
        - uuid: 8591c640d7654a9db395fb8cf79ca75b
          name: Localização
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.6.0
          key: sysLocation.0
          delay: 60m
          history: 1w
          value_type: TEXT
          trends: '0'
          description: 'Informa o modelo do aparelho'
          inventory_link: LOCATION
          tags:
            - tag: Application
              value: System
        - uuid: 094bae18b689438b8f8519a55c65f61e
          name: 'Tempo de atividade'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.3.0
          key: sysUpTime.0
          delay: 5m
          history: 1w
          value_type: FLOAT
          units: uptime
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: Application
              value: System
        - uuid: 6227fd6357b342c692a7932046853f45
          name: 'Endereço de IP'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.41112.1.6.3.1.0
          key: unifiApSystemIp.0
          delay: 10m
          history: 1w
          value_type: TEXT
          trends: '0'
          tags:
            - tag: Application
              value: 'AP Interface'
        - uuid: 3c16b85313594ace92f398479399ba21
          name: Modelo
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.41112.1.6.3.3.0
          key: unifiApSystemModel.0
          delay: 60m
          history: 1w
          value_type: TEXT
          trends: '0'
          description: 'Informa o modelo do aparelho'
          inventory_link: HARDWARE
          tags:
            - tag: Application
              value: System
        - uuid: 2f095dd773444d8b9706af85fdd797b0
          name: 'Versão do firmware'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.41112.1.6.3.6.0
          key: unifiApSystemVersion.0
          delay: 60m
          history: 1w
          value_type: TEXT
          trends: '0'
          inventory_link: SOFTWARE
          tags:
            - tag: Application
              value: System
        - uuid: b542f1ae0310446aa2aa78f11b793539
          name: 'Endereço MAC'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.41112.1.6.2.1.1.4.1
          key: unifiIfMac.1
          delay: 30m
          history: 1w
          value_type: TEXT
          trends: '0'
          inventory_link: MACADDRESS_A
          tags:
            - tag: Application
              value: 'AP Interface'
        - uuid: 0838921a9e0b46858dd40ee7632c002f
          name: 'Entrada de tráfego LAN'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.41112.1.6.2.1.1.6.1
          key: unifiIfRxBytes.1
          history: 1w
          units: Bps
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            - tag: Application
              value: 'AP Interface'
        - uuid: 21d9bba84eab47aa900632c1c8ba84e3
          name: 'Erros de entrada de tráfego LAN'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.41112.1.6.2.1.1.8.1
          key: unifiIfRxError.1
          history: 1w
          units: Error(s)
          tags:
            - tag: Application
              value: 'AP Interface'
        - uuid: fb00d3676afb4415a5e4a6d9e594b1e4
          name: 'Velocidade da interface (Mbit/s)'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.41112.1.6.2.1.1.11.1
          key: unifiIfSpeed.1
          delay: 60m
          history: 1w
          tags:
            - tag: Application
              value: 'AP Interface'
        - uuid: b1bf10834fa94803af6f0834aab64e36
          name: 'Tráfego LAN de saída'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.41112.1.6.2.1.1.12.1
          key: unifiIfTxBytes.1
          history: 1w
          units: Bps
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            - tag: Application
              value: 'AP Interface'
        - uuid: 75de8a9c6c4f49689e950851ee10cb2f
          name: 'Erros de saída de tráfego LAN'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.41112.1.6.2.1.1.14.1
          key: unifiIfTxError.1
          history: 1w
          units: Error(s)
          tags:
            - tag: Application
              value: 'AP Interface'
        - uuid: c8383e994dad49e6b1b02c9a79f9c187
          name: 'Utilização do canal 2G (BGN)'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.41112.1.6.1.1.1.6.1
          key: unifiRadioCuTotal.1
          delay: 30s
          history: 1w
          units: '%'
          description: 'Informa o modelo do aparelho'
          tags:
            - tag: Application
              value: 'Virtual Interfaces'
          triggers:
            - uuid: b6b83617f2004ef8ba70ffc654072c4c
              expression: 'avg(/UBQT UNIFI SNMP V1 HN/unifiRadioCuTotal.1,300s)=80'
              name: 'Utilização do canal 2G ativado {HOST.NAME} Alto'
              priority: WARNING
            - uuid: a3c3f99cd0084e9898bb61c48659f9d4
              expression: 'avg(/UBQT UNIFI SNMP V1 HN/unifiRadioCuTotal.1,300s)=90'
              name: 'Utilização do canal 2G ativado {HOST.NAME} muito alto'
              priority: AVERAGE
        - uuid: 2710974a386e4d1bb502b5c6f1f4268c
          name: 'Utilização do canal 5G (AC)'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.41112.1.6.1.1.1.6.2
          key: unifiRadioCuTotal.2
          delay: 30s
          history: 1w
          units: '%'
          description: 'Informa o modelo do aparelho'
          tags:
            - tag: Application
              value: 'Virtual Interfaces'
          triggers:
            - uuid: 85a1fc62400e4532966cd15f39a6e925
              expression: 'avg(/UBQT UNIFI SNMP V1 HN/unifiRadioCuTotal.2,300s)=80'
              name: 'Utilização do canal 5G ativado {HOST.NAME} Alto'
              priority: WARNING
            - uuid: b8b947afb46b42128bf81a86441e843c
              expression: 'avg(/UBQT UNIFI SNMP V1 HN/unifiRadioCuTotal.2,300s)=90'
              name: 'Utilização do canal 5G ativado {HOST.NAME} muito alto'
              priority: AVERAGE
        - uuid: ce32a52c196749d694b932ca0c9fa56d
          name: 'Nome de host do AP'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.5.0
          key: unifiSysName.0
          delay: 60m
          history: 1w
          value_type: TEXT
          trends: '0'
          inventory_link: NAME
          tags:
            - tag: Application
              value: System
        - uuid: fc1bd6e2fcb64767bd875f7cd6daa6ce
          name: 'Canal 2G (N/G)'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.41112.1.6.1.2.1.4.1
          key: unifiVapChannel.1
          history: 1w
          status: DISABLED
          description: 'Informa o modelo do aparelho'
          tags:
            - tag: Application
              value: System
        - uuid: 7c9ef5f259c94902b11f2df81d92f311
          name: 'Canal 5G (N/AC)'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.41112.1.6.1.2.1.4.5
          key: unifiVapChannel.5
          history: 1w
          status: DISABLED
          description: 'Informa o modelo do aparelho'
          tags:
            - tag: Application
              value: System
      discovery_rules:
        - uuid: c2e209ef450a4d748be3a8f6c0401759
          name: 'Interfaces virtuais Wi-Fi'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#UNIFIVAPESSID},.1.3.6.1.4.1.41112.1.6.1.2.1.6, {#UNIVAPRADIO},.1.3.6.1.4.1.41112.1.6.1.2.1.9]'
          key: unifiVapEssId
          delay: 30s
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          item_prototypes:
            - uuid: 5278b3c51242401580d2d45c4d4f01b5
              name: 'Canal Wi-Fi {#UNIVAPRADIO} on {#UNIFIVAPESSID}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.41112.1.6.1.2.1.4.{#SNMPINDEX}'
              key: 'unifiVapChannel[{#UNIFIVAPESSID},{#UNIVAPRADIO}]'
              history: 90d
              tags:
                - tag: Application
                  value: 'Virtual Interfaces'
            - uuid: 07c762c6dbc64439bf6100dc8c005c6a
              name: 'Usuarios {#UNIVAPRADIO} em {#UNIFIVAPESSID}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.41112.1.6.1.2.1.8.{#SNMPINDEX}'
              key: 'unifiVapNumStations[{#UNIFIVAPESSID},{#UNIVAPRADIO}]'
              delay: 30s
              history: 90d
              units: Users
              tags:
                - tag: Application
                  value: 'Virtual Interfaces'
            - uuid: f548899b0a9e4e38a3edd7e8f0956be2
              name: 'Entrada de tráfego {#UNIVAPRADIO} on {#UNIFIVAPESSID}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.41112.1.6.1.2.1.10.{#SNMPINDEX}'
              key: 'unifiVapRxBytes[{#UNIFIVAPESSID},{#UNIVAPRADIO}]'
              delay: 30s
              history: 90d
              units: Bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Application
                  value: 'Virtual Interfaces'
            - uuid: cbcb004b4a9144e6a6a6bd0578e38543
              name: 'Erros de entrada de tráfego por segundo {#UNIVAPRADIO} on {#UNIFIVAPESSID}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.41112.1.6.1.2.1.13.{#SNMPINDEX}'
              key: 'unifiVapRxErrors[{#UNIFIVAPESSID},{#UNIVAPRADIO}]'
              delay: 60s
              history: 90d
              units: Error/s
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Application
                  value: 'Virtual Interfaces'
            - uuid: b09c2dc994e94f5d92ddbeb921a39d4f
              name: 'Tráfego de saída {#UNIVAPRADIO} on {#UNIFIVAPESSID}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.41112.1.6.1.2.1.16.{#SNMPINDEX}'
              key: 'unifiVapTxBytes[{#UNIFIVAPESSID},{#UNIVAPRADIO}]'
              delay: 30s
              history: 90d
              units: Bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Application
                  value: 'Virtual Interfaces'
            - uuid: b01ee4e1d8874b47bd9cbb8b233770aa
              name: 'Erros de tráfego de saída por segundo {#UNIVAPRADIO} on {#UNIFIVAPESSID}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.41112.1.6.1.2.1.18.{#SNMPINDEX}'
              key: 'unifiVapTxErrors[{#UNIFIVAPESSID},{#UNIVAPRADIO}]'
              delay: 60s
              history: 90d
              units: Error/s
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Application
                  value: 'Virtual Interfaces'
          graph_prototypes:
            - uuid: 28f6f2e629b94f559564bfe7284d1750
              name: 'Usuarios {#UNIVAPRADIO} conectados em {#UNIFIVAPESSID}'
              show_work_period: 'NO'
              show_triggers: 'NO'
              type: STACKED
              graph_items:
                - color: 1A7C11
                  item:
                    host: 'UBQT UNIFI SNMP V1 HN'
                    key: 'unifiVapNumStations[{#UNIFIVAPESSID},{#UNIVAPRADIO}]'
      macros:
        - macro: '{$SNMP_COMMUNITY}'
          value: public
        - macro: '{$SNMP_PORT}'
          value: '161'
  graphs:
    - uuid: 95f7a11835b647e2832372124322398d
      name: 'Carga da CPU'
      ymin_type_1: FIXED
      graph_items:
        - color: 1A7C11
          item:
            host: 'UBQT UNIFI SNMP V1 HN'
            key: IaLoad.1
        - sortorder: '1'
          color: '000099'
          item:
            host: 'UBQT UNIFI SNMP V1 HN'
            key: IaLoad.2
        - sortorder: '2'
          color: '990000'
          item:
            host: 'UBQT UNIFI SNMP V1 HN'
            key: IaLoad.3
    - uuid: 54c231ee93764568939421f8785d149a
      name: 'Tráfego de rede'
      show_work_period: 'NO'
      show_triggers: 'NO'
      type: STACKED
      graph_items:
        - color: 1A7C11
          item:
            host: 'UBQT UNIFI SNMP V1 HN'
            key: unifiIfRxBytes.1
        - sortorder: '1'
          color: F63100
          item:
            host: 'UBQT UNIFI SNMP V1 HN'
            key: unifiIfTxBytes.1
    - uuid: 6dcb7b145c514a3ab77b73d83e11c370
      name: 'Utilização da CPU'
      type: STACKED
      ymax_type_1: FIXED
      graph_items:
        - color: 1A7C11
          item:
            host: 'UBQT UNIFI SNMP V1 HN'
            key: cpuLoad.0
    - uuid: 57bea729e862422d92e8088649b34462
      name: 'Utilização do canal'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        - color: 1A7C11
          item:
            host: 'UBQT UNIFI SNMP V1 HN'
            key: unifiRadioCuTotal.1
        - sortorder: '1'
          color: F63100
          item:
            host: 'UBQT UNIFI SNMP V1 HN'
            key: unifiRadioCuTotal.2
